# Oracle Level 02 ‚Üí 03 Get-WinEvent -Path .\Oracle3_Security.evtx

## Previous Flag
```
2f5c4
```

## Goal
The password for oracle4 is the date that the system logs were last wiped as depicted in the event logs on the desktop.<br>

NOTE: The format for the password is 2 digit month, 2 digit day, 4 digit year. Ex: 5 Jan 2015 would be 01/05/2015.

## What I learned
```
Get-WinEvent is a cmdlet that lets you query and read Windows Event Logs

Get-WinEvent -Path .\Oracle3_Security.evtx

.evtx file is a Windows Event Log file
    Windows records system, security, and application events into log files that can be viewed in the Event Viewer (eventvwr.msc)
    Application.evtx ‚Üí application-related events
    System.evtx ‚Üí OS and driver events
    Security.evtx ‚Üí logon, logoff, and audit events
    Oracle3_Security.evtx in your case looks like a saved/exported Security event log file
```

## Solution
```
PS C:\Users\trung.DESKTOP-G7C81CH\Downloads\01noobHacker> ssh oracle3@groot.underthewire.tech -p 22 ‚å®Ô∏è
oracle3@groot.underthewire.tech's password: ‚å®Ô∏è 2f5c4

Windows PowerShell 
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!

PS C:\users\Oracle3\desktop> dir ‚å®Ô∏è

    Directory: C:\users\Oracle3\desktop

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        8/30/2018   5:52 AM        1118208 Oracle3_Security.evtx üëÄ

PS C:\users\Oracle3\desktop> Get-Help Get-WinEvent ‚å®Ô∏è
PS C:\users\Oracle3\desktop> Get-WinEvent -Path .\Oracle3_Security.evtx ‚å®Ô∏è

   ProviderName: Microsoft-Windows-Security-Auditing

TimeCreated                     Id LevelDisplayName Message
-----------                     -- ---------------- -------
5/18/2017 11:38:23 PM         4624 Information      An account was successfully logged on....
5/18/2017 11:38:23 PM         4672 Information      Special privileges assigned to new logon....
5/18/2017 11:38:23 PM         4634 Information      An account was logged off....
5/18/2017 11:37:38 PM         4624 Information      An account was successfully logged on....
5/18/2017 11:37:38 PM         4776 Information      The computer attempted to validate the credentials for an account....
5/18/2017 11:37:32 PM         4624 Information      An account was successfully logged on....
5/18/2017 11:37:32 PM         4672 Information      Special privileges assigned to new logon....
5/18/2017 11:37:32 PM         4634 Information      An account was logged off....
5/18/2017 11:37:31 PM         4624 Information      An account was successfully logged on....
5/18/2017 11:37:31 PM         4776 Information      The computer attempted to validate the credentials for an account....
5/18/2017 11:37:31 PM         4624 Information      An account was successfully logged on....
5/18/2017 11:37:31 PM         4776 Information      The computer attempted to validate the credentials for an account....
5/18/2017 11:37:31 PM         4634 Information      An account was logged off....
5/18/2017 11:37:31 PM         4624 Information      An account was successfully logged on....
5/18/2017 11:37:31 PM         4672 Information      Special privileges assigned to new logon....
5/18/2017 11:37:26 PM         4688 Information      A new process has been created....
5/18/2017 11:37:26 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:37:26 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:37:26 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:37:26 PM         4688 Information      A new process has been created....
5/18/2017 11:37:26 PM         4688 Information      A new process has been created....
5/18/2017 11:37:26 PM         4673 Information      A privileged service was called....
5/18/2017 11:37:26 PM         4611 Information      A trusted logon process has been registered with the Local Security Authority....
5/18/2017 11:37:25 PM         4673 Information      A privileged service was called....
5/18/2017 11:37:25 PM         4611 Information      A trusted logon process has been registered with the Local Security Authority....
5/18/2017 11:37:25 PM         4688 Information      A new process has been created....
5/18/2017 11:37:23 PM         4688 Information      A new process has been created....
5/18/2017 11:37:21 PM         4688 Information      A new process has been created....
5/18/2017 11:37:21 PM         4688 Information      A new process has been created....
5/18/2017 11:37:21 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:37:21 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:37:21 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:37:13 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:37:13 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:53 PM         4688 Information      A new process has been created....
5/18/2017 11:36:50 PM         4688 Information      A new process has been created....
5/18/2017 11:36:50 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:36:50 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:50 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:46 PM         4688 Information      A new process has been created....
5/18/2017 11:36:46 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:36:46 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:36:44 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:44 PM         4673 Information      A privileged service was called....
5/18/2017 11:36:44 PM         4688 Information      A new process has been created....
5/18/2017 11:36:44 PM         4688 Information      A new process has been created....
5/18/2017 11:36:44 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:43 PM         4688 Information      A new process has been created....
5/18/2017 11:36:43 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:43 PM         4634 Information      An account was logged off....
5/18/2017 11:36:43 PM         4634 Information      An account was logged off....
5/18/2017 11:36:43 PM         4624 Information      An account was successfully logged on....
5/18/2017 11:36:43 PM         4672 Information      Special privileges assigned to new logon....
5/18/2017 11:36:43 PM         4688 Information      A new process has been created....
5/18/2017 11:36:43 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:43 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:43 PM         4688 Information      A new process has been created....
5/18/2017 11:36:43 PM         4673 Information      A privileged service was called....
5/18/2017 11:36:43 PM         4688 Information      A new process has been created....
5/18/2017 11:36:43 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:43 PM         4673 Information      A privileged service was called....
5/18/2017 11:36:41 PM         4688 Information      A new process has been created....
5/18/2017 11:36:41 PM         4688 Information      A new process has been created....
5/18/2017 11:36:41 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:36:41 PM         4672 Information      Special privileges assigned to new logon....
5/18/2017 11:36:41 PM         4624 Information      An account was successfully logged on....
5/18/2017 11:36:41 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:36:41 PM         4673 Information      A privileged service was called....
5/18/2017 11:36:41 PM         4688 Information      A new process has been created....
5/18/2017 11:36:41 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:36:41 PM         4688 Information      A new process has been created....
5/18/2017 11:36:41 PM         4688 Information      A new process has been created....
5/18/2017 11:36:41 PM         4688 Information      A new process has been created....
5/18/2017 11:36:41 PM         4688 Information      A new process has been created....
5/18/2017 11:36:41 PM         4688 Information      A new process has been created....
5/18/2017 11:36:41 PM         4688 Information      A new process has been created....
5/18/2017 11:36:41 PM         4688 Information      A new process has been created....
5/18/2017 11:36:41 PM         4688 Information      A new process has been created....
5/18/2017 11:36:41 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:36:41 PM         4672 Information      Special privileges assigned to new logon....
5/18/2017 11:36:41 PM         4624 Information      An account was successfully logged on....
5/18/2017 11:36:41 PM         4688 Information      A new process has been created....
5/18/2017 11:36:41 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:36:41 PM         4688 Information      A new process has been created....
5/18/2017 11:36:41 PM         4688 Information      A new process has been created....
5/18/2017 11:36:40 PM         4688 Information      A new process has been created....
5/18/2017 11:36:40 PM         4688 Information      A new process has been created....
5/18/2017 11:36:40 PM         4688 Information      A new process has been created....
5/18/2017 11:36:40 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:36:40 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:40 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:40 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:40 PM         4634 Information      An account was logged off....
5/18/2017 11:36:40 PM         4634 Information      An account was logged off....
5/18/2017 11:36:40 PM         4634 Information      An account was logged off....
5/18/2017 11:36:40 PM         4624 Information      An account was successfully logged on....
5/18/2017 11:36:40 PM         4672 Information      Special privileges assigned to new logon....
5/18/2017 11:36:40 PM         4648 Information      A logon was attempted using explicit credentials....
5/18/2017 11:36:40 PM         4624 Information      An account was successfully logged on....
5/18/2017 11:36:40 PM         4672 Information      Special privileges assigned to new logon....
5/18/2017 11:36:40 PM         4634 Information      An account was logged off....
5/18/2017 11:36:40 PM         4634 Information      An account was logged off....
5/18/2017 11:36:40 PM         4624 Information      An account was successfully logged on....
5/18/2017 11:36:40 PM         4672 Information      Special privileges assigned to new logon....
5/18/2017 11:36:40 PM         4648 Information      A logon was attempted using explicit credentials....
5/18/2017 11:36:40 PM         4624 Information      An account was successfully logged on....
5/18/2017 11:36:40 PM         4672 Information      Special privileges assigned to new logon....
5/18/2017 11:36:40 PM         4624 Information      An account was successfully logged on....
5/18/2017 11:36:40 PM         4672 Information      Special privileges assigned to new logon....
5/18/2017 11:36:40 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:40 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:40 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:40 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:40 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:39 PM         4673 Information      A privileged service was called....
5/18/2017 11:36:39 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:39 PM         4673 Information      A privileged service was called....
5/18/2017 11:36:39 PM         4688 Information      A new process has been created....
5/18/2017 11:36:39 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:36:39 PM         4688 Information      A new process has been created....
5/18/2017 11:36:39 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:39 PM         4673 Information      A privileged service was called....
5/18/2017 11:36:39 PM         4688 Information      A new process has been created....
5/18/2017 11:36:39 PM         4688 Information      A new process has been created....
5/18/2017 11:36:39 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:39 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:39 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:39 PM         4985 Information      The state of a transaction has changed....
5/18/2017 11:36:39 PM         4688 Information      A new process has been created....
5/18/2017 11:36:39 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:36:39 PM         4688 Information      A new process has been created....
5/18/2017 11:36:39 PM         4670 Information      Permissions on an object were changed....
5/18/2017 11:36:39 PM         4688 Information      A new process has been created....
5/18/2017 11:36:39 PM         4688 Information      A new process has been created....
5/18/2017 11:36:39 PM         4688 Information      A new process has been created....
5/18/2017 11:36:39 PM         4688 Information      A new process has been created....
5/18/2017 11:36:39 PM         4688 Information      A new process has been created....
5/18/2017 11:36:39 PM         4688 Information      A new process has been created....
5/18/2017 11:36:38 PM         4616 Information      The system time was changed....
5/18/2017 11:36:38 PM         4616 Information      The system time was changed....
5/9/2017 11:36:38 PM          4624 Information      An account was successfully logged on....
5/9/2017 11:36:38 PM          4672 Information      Special privileges assigned to new logon....
5/9/2017 11:36:32 PM          4688 Information      A new process has been created....
5/9/2017 11:36:32 PM          4673 Information      A privileged service was called....
5/9/2017 11:36:32 PM          4611 Information      A trusted logon process has been registered with the Local Security Authority....
5/9/2017 11:36:32 PM          4634 Information      An account was logged off....
5/9/2017 11:36:32 PM          4624 Information      An account was successfully logged on....
5/9/2017 11:36:32 PM          4672 Information      Special privileges assigned to new logon....
5/9/2017 11:36:30 PM          4673 Information      A privileged service was called....
5/9/2017 11:36:30 PM          4673 Information      A privileged service was called....
5/9/2017 11:36:30 PM          4611 Information      A trusted logon process has been registered with the Local Security Authority....
5/9/2017 11:36:30 PM          4688 Information      A new process has been created....
5/9/2017 11:36:28 PM          4688 Information      A new process has been created....
5/9/2017 11:36:28 PM          4688 Information      A new process has been created....

   ProviderName: Microsoft-Windows-Eventlog

TimeCreated                     Id LevelDisplayName Message
-----------                     -- ---------------- -------
5/9/2017 11:36:05 PM          1102 Information      The audit log was cleared.... üëÄ

   ProviderName: Microsoft-Windows-Security-Auditing

TimeCreated                     Id LevelDisplayName Message
-----------                     -- ---------------- -------
5/9/2017 11:36:04 PM          4634 Information      An account was logged off....
5/9/2017 11:36:04 PM          4624 Information      An account was successfully logged on....
5/9/2017 11:36:04 PM          4672 Information      Special privileges assigned to new logon....
5/9/2017 11:36:04 PM          4688 Information      A new process has been created....
5/9/2017 11:36:04 PM          4670 Information      Permissions on an object were changed....
5/9/2017 11:36:04 PM          4670 Information      Permissions on an object were changed....
5/9/2017 11:36:04 PM          4670 Information      Permissions on an object were changed....
5/9/2017 11:36:04 PM          4688 Information      A new process has been created....

PS C:\users\Oracle3\desktop> Get-WinEvent -Path .\Oracle3_Security.evtx | Where-Object {$_.Message -like '*clear*'} ‚å®Ô∏è

   ProviderName: Microsoft-Windows-Eventlog

TimeCreated                     Id LevelDisplayName Message
-----------                     -- ---------------- -------
5/9/2017 11:36:05 PM          1102 Information      The audit log was cleared.... üëÄ

PS C:\users\Oracle3\desktop> (Get-WinEvent -Path .\Oracle3_Security.evtx | Where-Object {$_.Message -like '*clear*'}).TimeCreated.ToString('MM/dd/yyyy') ‚å®Ô∏è
05/09/2017 üîê

PS C:\users\Oracle3\desktop> exit ‚å®Ô∏è
Connection to groot.underthewire.tech closed.
PS C:\Users\trung.DESKTOP-G7C81CH\Downloads\01noobHacker> ssh oracle4@groot.underthewire.tech -p 22 ‚å®Ô∏è
oracle4@groot.underthewire.tech's password: ‚å®Ô∏è 05/09/2017

Windows PowerShell 
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

Under the Wire... PowerShell Training for the People!
PS C:\users\Oracle4\desktop> whoami ‚å®Ô∏è
underthewire\oracle4
```

## Flag
05/09/2017

## Continue
[Continue](./Oracle0304.md)